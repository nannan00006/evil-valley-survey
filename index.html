<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¶äººè°· - æš—é»‘é—®å·</title>
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
          integrity="sha512-dOxO9kQvGvjKqJsteVEh9UpAJZxkd06P88eaJEo5gqU7E5Wdl66iRS0LlwM651c01qmPvvrL1jAUx0xCP3k8xw=="
          crossorigin="anonymous" referrerpolicy="no-referrer" />

    <style>
        :root {
            --dark-bg: #050509;
            --dark-card: #15151c;
            --accent-red: #ff0033;
            --accent-purple: #8a2be2;
            --text-light: #e0e0e0;
            --text-muted: #888;
            --blood-red: #8b0000;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Microsoft YaHei', system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
        }

        body {
            background-color: var(--dark-bg);
            color: var(--text-light);
            min-height: 100vh;
            background-image:
                radial-gradient(circle at 10% 20%, rgba(255, 0, 51, 0.08) 0%, transparent 35%),
                radial-gradient(circle at 90% 80%, rgba(138, 43, 226, 0.08) 0%, transparent 35%);
            overflow-x: hidden;
            position: relative;
            animation: fade-in-body 0.8s ease-out;
        }

        body::before {
            content: "";
            position: fixed;
            inset: 0;
            background:
                radial-gradient(circle at 20% 30%, rgba(139, 0, 0, 0.12) 0%, transparent 55%),
                radial-gradient(circle at 80% 70%, rgba(138, 43, 226, 0.12) 0%, transparent 55%);
            pointer-events: none;
            z-index: -2;
        }

        /* èƒŒæ™¯ç²’å­ */
        .particle {
            position: fixed;
            width: 3px;
            height: 3px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.25);
            box-shadow: 0 0 6px rgba(255, 0, 51, 0.6);
            pointer-events: none;
            z-index: -1;
            animation: float-particle 12s linear infinite;
        }

        @keyframes float-particle {
            0% { transform: translateY(0); opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { transform: translateY(-120vh); opacity: 0; }
        }

        @keyframes fade-in-body {
            from { opacity: 0; transform: translateY(10px); }
            to   { opacity: 1; transform: translateY(0); }
        }

        .container {
            max-width: 1100px;
            margin: 0 auto;
            padding: 24px 16px 40px;
        }

        header {
            text-align: center;
            padding: 32px 0 24px;
            position: relative;
            margin-bottom: 24px;
        }

        h1 {
            font-size: 2.6rem;
            color: var(--accent-red);
            text-shadow: 0 0 12px rgba(255, 0, 51, 0.6);
            margin-bottom: 10px;
            letter-spacing: 3px;
            position: relative;
            display: inline-block;
        }

        h1::after {
            content: "";
            position: absolute;
            bottom: -12px;
            left: 12%;
            width: 76%;
            height: 3px;
            background: linear-gradient(90deg, transparent, var(--accent-red), transparent);
        }

        .subtitle {
            color: var(--text-muted);
            font-size: 1.1rem;
            margin-top: 18px;
        }

        /* ä½ çš„å°ç©æ„ä»¬çš„å®¹å™¨ */
        .floating-elements {
            position: absolute;
            inset: 0;
            pointer-events: none;
            z-index: -1;
        }

        .floating-element {
            position: absolute;
            opacity: 0.8;
            font-size: 2rem;
            filter: drop-shadow(0 0 6px rgba(255, 0, 51, 0.7));
        }

        /* çœ¼é•œ */
        .glasses {
            top: 8%;
            left: 6%;
            animation: float 8s ease-in-out infinite;
            color: #ffffff;
        }

        /* æ¨±æ¡ƒï¼šç”¨ emojiï¼Œæ›´åƒçœŸçš„ğŸ’ */
        .cherry {
            top: 20%;
            right: 9%;
            animation: float 7s ease-in-out infinite 0.8s;
            color: var(--blood-red);
        }

        /* åå­—æ¶è€³é’‰ Aï¼šå†·ç™½ç´«è‰² */
        .earring-a {
            bottom: 18%;
            left: 15%;
            animation: float 9s ease-in-out infinite 0.3s;
            color: var(--accent-purple);
        }

        /* åå­—æ¶è€³é’‰ Bï¼šåçº¢ï¼ŒAB æ¬¾ */
        .earring-b {
            bottom: 12%;
            left: 23%;
            animation: float 10s ease-in-out infinite 1s;
            color: var(--accent-red);
        }

        /* ç¯®çƒ */
        .basketball {
            bottom: 22%;
            right: 6%;
            animation: float 11s ease-in-out infinite 1.5s;
            color: #ff8c00;
        }

        @keyframes float {
            0%   { transform: translateY(0) rotate(0deg); }
            50%  { transform: translateY(-18px) rotate(4deg); }
            100% { transform: translateY(0) rotate(0deg); }
        }

        .survey-container,
        .results {
            background-color: var(--dark-card);
            border-radius: 14px;
            padding: 26px 22px 26px;
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.6);
            margin-bottom: 28px;
            border: 1px solid rgba(255, 255, 255, 0.06);
            position: relative;
            overflow: hidden;
            animation: fade-up 0.5s ease-out;
        }

        .survey-container::before,
        .results::before {
            content: "";
            position: absolute;
            top: 0;
            left: -10%;
            width: 120%;
            height: 4px;
            background: linear-gradient(90deg, var(--accent-red), var(--accent-purple));
        }

        @keyframes fade-up {
            from { opacity: 0; transform: translateY(14px); }
            to   { opacity: 1; transform: translateY(0); }
        }

        .question {
            margin-bottom: 26px;
            padding: 20px 4px 18px;
            border-bottom: 1px dashed rgba(255, 255, 255, 0.15);
            position: relative;
        }

        .question:last-child {
            border-bottom: none;
            margin-bottom: 10px;
        }

        .question-number {
            position: absolute;
            left: -14px;
            top: -6px;
            background: radial-gradient(circle at 30% 30%, #fff, var(--accent-red));
            color: #fff;
            width: 32px;
            height: 32px;
            border-radius: 999px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.95rem;
            box-shadow: 0 0 12px rgba(255, 0, 51, 0.75);
        }

        .question-text {
            font-size: 1.15rem;
            margin-bottom: 14px;
            color: var(--text-light);
            margin-left: 28px;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 9px;
        }

        .option {
            display: flex;
            align-items: center;
            padding: 11px 14px;
            background-color: rgba(255, 255, 255, 0.04);
            border-radius: 7px;
            cursor: pointer;
            transition: all 0.22s ease;
            border: 1px solid transparent;
            font-size: 0.98rem;
        }

        .option:hover {
            background-color: rgba(255, 255, 255, 0.1);
            transform: translateX(5px);
            border-color: rgba(255, 0, 51, 0.35);
        }

        .option input {
            margin-right: 10px;
            accent-color: var(--accent-red);
        }

        .btn {
            background: linear-gradient(135deg, var(--accent-red), #ff4b6e);
            color: #fff;
            border: none;
            padding: 11px 24px;
            border-radius: 999px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.98rem;
            letter-spacing: 0.5px;
            transition: all 0.24s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 18px rgba(255, 0, 51, 0.35);
            filter: brightness(1.05);
        }

        .btn:active {
            transform: translateY(0);
            box-shadow: none;
        }

        .btn-purple {
            background: linear-gradient(135deg, var(--accent-purple), #b574ff);
        }

        .results {
            margin-top: 10px;
            display: none;
        }

        .results h2 {
            color: var(--accent-purple);
            margin-bottom: 18px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .results h2 i {
            color: var(--accent-red);
        }

        .result-item {
            margin-bottom: 14px;
            padding: 14px 14px 12px;
            background-color: rgba(255, 255, 255, 0.04);
            border-radius: 8px;
            transition: all 0.22s ease;
        }

        .result-item:hover {
            transform: translateX(4px);
        }

        .correct {
            border-left: 4px solid #00cc66;
        }

        .incorrect {
            border-left: 4px solid var(--accent-red);
        }

        .score-display {
            text-align: center;
            margin-bottom: 22px;
            padding: 16px 12px;
            background: radial-gradient(circle at top, rgba(255, 0, 51, 0.13), transparent 55%);
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.09);
        }

        .score-value {
            font-size: 2.4rem;
            font-weight: 800;
            color: var(--accent-red);
            text-shadow: 0 0 10px rgba(255, 0, 51, 0.6);
        }

        .tagline {
            margin-top: 6px;
            color: var(--text-muted);
            font-size: 0.95rem;
        }

        .camp-result {
            margin-bottom: 18px;
            padding: 14px 14px 12px;
            border-radius: 10px;
            background: rgba(0, 0, 0, 0.35);
            border: 1px solid rgba(255, 255, 255, 0.08);
        }

        .camp-name {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 4px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .camp-name span.badge {
            font-size: 0.8rem;
            padding: 2px 8px;
            border-radius: 999px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .evil-quote {
            margin-top: 8px;
            font-size: 0.9rem;
            color: var(--text-muted);
            font-style: italic;
        }

        .progress-container {
            margin-bottom: 20px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 10px;
            padding: 13px 14px 12px;
            border: 1px solid rgba(255, 255, 255, 0.06);
        }

        .progress-bar {
            height: 10px;
            background: rgba(255, 255, 255, 0.08);
            border-radius: 999px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-purple), var(--accent-red));
            width: 0%;
            transition: width 0.4s ease;
        }

        .progress-text {
            display: flex;
            justify-content: space-between;
            margin-top: 5px;
            font-size: 0.88rem;
            color: var(--text-muted);
        }

        .button-container {
            text-align: center;
            margin: 18px 0 10px;
            display: flex;
            justify-content: center;
            gap: 16px;
            flex-wrap: wrap;
        }

        .hint-text {
            text-align: center;
            margin-top: 4px;
            font-size: 0.8rem;
            color: var(--text-muted);
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 2.1rem;
            }
            header {
                padding-top: 26px;
            }
            .survey-container, .results {
                padding: 20px 16px 22px;
            }
            .option {
                padding: 9px 11px;
            }
            .floating-element {
                font-size: 1.6rem;
            }
        }

        @media (max-width: 480px) {
            h1 { font-size: 1.8rem; }
            .container { padding-inline: 10px; }
            .survey-container, .results { padding: 16px 12px 18px; }
            .question-number {
                left: -10px;
                width: 26px;
                height: 26px;
                font-size: 0.85rem;
            }
            .question-text { margin-left: 20px; }
            .button-container { flex-direction: column; }
        }
    </style>
</head>
<body>
<div class="container">
    <header>
        <h1>æ¶äººè°·é—®å·è°ƒæŸ¥</h1>
        <p class="subtitle">æš—é»‘ä¸–ç•Œçš„çµé­‚å°æµ‹ Â· ä½ åˆ°åº•æœ‰å¤šå…¥è°·ï¼Ÿ</p>

        <div class="floating-elements">
            <!-- JS åŠ¨æ€æ’å…¥ï¼šçœ¼é•œ / æ¨±æ¡ƒ / è€³é’‰AB / ç¯®çƒ -->
        </div>
    </header>

    <div class="progress-container">
        <div class="progress-bar">
            <div class="progress-fill" id="progress-fill"></div>
        </div>
        <div class="progress-text">
            <span><i class="fas fa-list-check"></i> é—®å·è¿›åº¦</span>
            <span id="progress-text">0%</span>
        </div>
    </div>

    <section class="survey-container" id="survey">
        <!-- é—®é¢˜ç”± JS åŠ¨æ€ç”Ÿæˆ -->
    </section>

    <div class="button-container">
        <button class="btn" id="submit-btn">
            <i class="fas fa-paper-plane"></i> æäº¤é—®å·
        </button>
        <button class="btn btn-purple" id="reset-btn">
            <i class="fas fa-rotate-right"></i> é‡ç½®é‡æ¥
        </button>
    </div>
    <p class="hint-text">* è¿™æ˜¯æ¶äººè°·ä¸–ç•Œè§‚å†…çš„å°æµ‹è¯•ï¼Œä»…ä¾›å¿«ä¹å…¥è°·ï¼Œä¸ä»£è¡¨ä»»ä½•ç°å®ç«‹åœºã€‚</p>

    <section class="results" id="results">
        <h2><i class="fas fa-poll"></i> é—®å·ç»“æœ</h2>
        <!-- ç»“æœç”± JS åŠ¨æ€ç”Ÿæˆ -->
    </section>
</div>

<script>
    // ===== èƒŒæ™¯ç²’å­ =====
    function createParticles(count = 25) {
        for (let i = 0; i < count; i++) {
            const p = document.createElement('div');
            p.className = 'particle';
            const size = Math.random() * 3 + 2;
            p.style.width = size + 'px';
            p.style.height = size + 'px';
            p.style.left = Math.random() * 100 + 'vw';
            p.style.top = (Math.random() * 100 + 20) + 'vh';
            p.style.animationDelay = (Math.random() * 12) + 's';
            document.body.appendChild(p);
        }
    }

// å…¨éƒ¨æ”¹æˆæ–‡å­— / emojiï¼Œå°ç©æ„å¿…æ˜¾ç¤ºç‰ˆ
const floatingElements = [
    // çœ¼é•œ
    { class: 'glasses',   type: 'text', text: 'ğŸ‘“', size: '40px' },

    // æ¨±æ¡ƒ
    { class: 'cherry',    type: 'text', text: 'ğŸ’', size: '34px' },

    // åå­—æ¶è€³é’‰ A
    { class: 'earring-a', type: 'text', text: 'âœ',  size: '30px' },

    // åå­—æ¶è€³é’‰ Bï¼ˆç¨å¾®æ–œä¸€ç‚¹ï¼Œå½“ AB æ¬¾ï¼‰
    { class: 'earring-b', type: 'text', text: 'âœ',  size: '26px', rotate: '-25deg' },

    // ç¯®çƒ
    { class: 'basketball',type: 'text', text: 'ğŸ€', size: '42px' }
];


    // ===== é—®å·é—®é¢˜ & é˜µè¥è®¾å®š =====
    const questions = [
        {
            id: 1,
            text: "å¼ å¼ºå‡ºåœºæ—¶ï¼Œæœ€æ ‡å¿—æ€§çš„ä¸œè¥¿æ˜¯ï¼Ÿ",
            options: [
                { text: "æ‰‹æœº",         character: "cha" },
                { text: "ç§äººæ¿æ¡†",     character: "meanwei" },
                { text: "æŠ«è¨å°ç‹—",     character: "zhangqiang" },
                { text: "å†·å¸½",         character: "lintao" }
            ],
            correctAnswer: "æŠ«è¨å°ç‹—"
        },
        {
            id: 2,
            text: "å°chaçš„æ„Ÿæƒ…èµ°å‘ï¼Œæœ€ç¬¦åˆä½ å¿ƒé‡Œçš„â€œå®˜é…è®¤çŸ¥â€ï¼Ÿ",
            options: [
                { text: "é˜´æ¹¿ç”·é¬¼æ—æ¶›",        character: "lintao" },
                { text: "åŠæ¯›æå",            character: "lihua" },
                { text: "æŒæ§å“¥å¼ å¼º",          character: "zhangqiang" },
                { text: "all inï¼ˆæˆ‘å…¨éƒ½è¦ï¼‰",   character: "cha-all" }
            ],
            correctAnswer: "all inï¼ˆæˆ‘å…¨éƒ½è¦ï¼‰"
        },
        {
            id: 3,
            text: "meanä¼Ÿçš„åˆå»äº‹ä»¶é‡Œï¼Œä½ ç¬¬ä¸€ååº”æƒ³åˆ°çš„åœºæ™¯æ˜¯ï¼Ÿ",
            options: [
                { text: "å­¦æ ¡",     character: "lintao" },
                { text: "è¿˜æ²¡å‘ç”Ÿ", character: "lihua" },
                { text: "ç§Ÿçš„æˆ¿å­", character: "cha" },
                { text: "æ²™å‘",     character: "meanwei" }
            ],
            correctAnswer: "æ²™å‘"
        },
        {
            id: 4,
            text: "æåä¸chaé‚£æ¬¡â€œè¨ç“¦è¿ªå¡â€ååœºé¢ï¼Œä½ çš„è®°å¿†æ˜¯ï¼Ÿ",
            options: [
                { text: "è¿˜æ²¡æœ‰å‘ç”Ÿ", character: "zhangqiang" },
                { text: "å¯†å®¤",       character: "lintao" },
                { text: "åˆšè§é¢",     character: "meanwei" },
                { text: "è¨ç“¦è¿ªå¡",   character: "lihua" }
            ],
            correctAnswer: "è¨ç“¦è¿ªå¡"
        }
    ];

    const characterProfiles = {
        zhangqiang: {
            name: "æŒæ§å“¥ Â· å¼ å¼ºé˜µè¥",
            badge: "æ§åˆ¶æ¬²æ‹…å½“",
            desc: "ä½ å¯¹æ—¶é—´çº¿å’Œå±€é¢çš„æ•æ„Ÿåº¦æé«˜ï¼Œä¹ æƒ¯ç«™åœ¨æ£‹ç›˜ä¸Šæ–¹ä¿¯è§†ä¸€åˆ‡ã€‚æ„Ÿæƒ…å¯¹ä½ æ¥è¯´æ—¢æ˜¯ç­¹ç ï¼Œä¹Ÿæ˜¯åº•çº¿ã€‚"
        },
        lintao: {
            name: "é˜´æ¹¿ç”·é¬¼ Â· æ—æ¶›é˜µè¥",
            badge: "æ‰§å¿µç³»åæ‰§ç‹‚",
            desc: "ä½ å¯¹ç»†èŠ‚ä¸æ°”æ°›å¼‚å¸¸æ•é”ï¼Œæ“…é•¿åœ¨é˜´å½±é‡Œè§‚å¯Ÿäººå¿ƒã€‚ä½ ç›¸ä¿¡ï¼ŒçœŸæ­£çš„æ€ä¼¤åŠ›ä»æ¥ä¸æ˜¯åˆ€ï¼Œè€Œæ˜¯â€œå¦‚æœå½“æ—¶â€ã€‚"
        },
        meanwei: {
            name: "èŠ±å­”é›€ Â· meanä¼Ÿé˜µè¥",
            badge: "ç¤¾äº¤åœºè€ç‹ç‹¸",
            desc: "ä½ æ“…é•¿åœ¨èšå…‰ç¯ä¸‹ä¿æŒä¼˜é›…ï¼Œå°è¯çŠ€åˆ©åˆå¥½ç¬‘ã€‚ä½ çŸ¥é“æ¯ä¸€æ¬¡å›çœ¸éƒ½æ˜¯æ­¦å™¨ï¼Œä¹ŸçŸ¥é“ä»€ä¹ˆæ—¶å€™è¯¥è½¬èº«ç¦»åœºã€‚"
        },
        cha: {
            name: "å°chaé˜µè¥",
            badge: "å‰§æƒ…æ ¸å¿ƒä½“",
            desc: "ä½ å¯¹æ‰€æœ‰äººçš„æƒ…ç»ªéƒ½å¾ˆæ•æ„Ÿï¼Œå´åˆä¹ æƒ¯æŠŠè‡ªå·±æ”¾åˆ°æœ€åã€‚ä½ æ˜¯æ•…äº‹çš„èµ·ç‚¹ä¹Ÿæ˜¯ç»ˆç‚¹ï¼Œæ˜¯æ‰€æœ‰æŠ‰æ‹©çš„æŠ˜å°„é•œã€‚"
        },
        lihua: {
            name: "å¯¼æ¼” Â· æåé˜µè¥",
            badge: "å‰§æœ¬æŒæ§è€…",
            desc: "ä½ æ€»æ˜¯åœ¨å†™å‰§æœ¬ï¼Œä¹Ÿæ€»åœ¨æ”¹å‰§æœ¬ã€‚ä½ æ“…é•¿æŠŠæ‰€æœ‰äººæ¨ä¸Šèˆå°ï¼Œå†åœ¨æš—å¤„è®°å½•ä»–ä»¬å´©æºƒæˆ–é‡ç”Ÿçš„ç¬é—´ã€‚"
        },
        neutral: {
            name: "è·¯è¿‡è§‚ä¼— Â· åƒç“œç¾¤ä¼—",
            badge: "å®‰å…¨åŒºç”Ÿå­˜è€…",
            desc: "ä½ è¿˜åœ¨å®‰å…¨è·ç¦»ä¹‹å¤–çœ‹æˆï¼ŒçŸ¥é“é‡Œé¢å¾ˆç–¯ï¼Œä½†åˆæ§åˆ¶ä¸ä½å¤šçœ‹ä¸€çœ¼ã€‚è¯´ä¸å®šå“ªå¤©ï¼Œä½ å°±èµ°ä¸Šå‰æ’äº†ã€‚"
        }
    };

    const evilQuotes = [
        "â€œé£èµ·æ—¶ï¼Œè¯·åˆ«å›å¤´ã€‚â€",
        "â€œä½ ä»¥ä¸ºä½ åœ¨é€‰æ‹©ï¼Œå…¶å®ä½ ä¸€ç›´åœ¨è¢«é€‰æ‹©ã€‚â€",
        "â€œå‘½è¿è½ç¬”æ— æƒ…ï¼Œå¯æœ‰äººåè¦æ‹¿å‘½æ”¹ç¨¿ã€‚â€",
        "â€œæˆ‘ä»¬éƒ½åœ¨æ¼”æˆï¼Œåªæ˜¯æœ‰çš„äººæ‹¿åˆ°äº†å‰§æœ¬ã€‚â€",
        "â€œæœ‰äº›äººæ­»åœ¨æ•…äº‹é‡Œï¼Œæœ‰äº›äººæ­»åœ¨æ•…äº‹å¼€å§‹ä¹‹å‰ã€‚â€"
    ];

    // ===== åˆå§‹åŒ– =====
    function init() {
        createParticles();

        // æ’å…¥æµ®åŠ¨å°ç©æ„
        const floatingContainer = document.querySelector('.floating-elements');
        floatingElements.forEach(element => {
            const el = document.createElement('div');
            el.className = `floating-element ${element.class}`;

            if (element.type === 'icon') {
                el.innerHTML = `<i class="fas ${element.icon}"></i>`;
            } else if (element.type === 'text') {
                el.textContent = element.text;
            }

            el.style.fontSize = element.size;
            if (element.rotate) {
                el.style.transform = `rotate(${element.rotate})`;
            }
            floatingContainer.appendChild(el);
        });

        // æ¸²æŸ“é—®é¢˜
        loadQuestions();

        document.getElementById('submit-btn').addEventListener('click', submitSurvey);
        document.getElementById('reset-btn').addEventListener('click', resetSurvey);

        updateProgress();
    }

    function loadQuestions() {
        const surveyContainer = document.getElementById('survey');
        surveyContainer.innerHTML = '';

        questions.forEach((question, index) => {
            const questionElement = document.createElement('div');
            questionElement.className = 'question';

            const optionsHTML = question.options.map(option => `
                <label class="option">
                    <input type="radio" name="question-${question.id}" value="${option.text}">
                    ${option.text}
                </label>
            `).join('');

            questionElement.innerHTML = `
                <div class="question-number">${index + 1}</div>
                <div class="question-text">${question.text}</div>
                <div class="options">
                    ${optionsHTML}
                </div>
            `;
            surveyContainer.appendChild(questionElement);
        });

        const optionLabels = document.querySelectorAll('.option');
        optionLabels.forEach(option => {
            option.addEventListener('click', updateProgress);
        });
    }

    function getAnsweredCount() {
        let answered = 0;
        questions.forEach(q => {
            const selected = document.querySelector(`input[name="question-${q.id}"]:checked`);
            if (selected) answered++;
        });
        return answered;
    }

    function updateProgress() {
        const totalQuestions = questions.length;
        const answered = getAnsweredCount();
        const progress = totalQuestions > 0 ? (answered / totalQuestions) * 100 : 0;
        document.getElementById('progress-fill').style.width = `${progress}%`;
        document.getElementById('progress-text').textContent = `${Math.round(progress)}%`;
    }

    function findOptionMeta(question, value) {
        return question.options.find(opt => opt.text === value);
    }

    function submitSurvey() {
        const answered = getAnsweredCount();
        if (answered < questions.length) {
            const goOn = confirm(`ä½ è¿˜æœ‰ ${questions.length - answered} é¢˜æ²¡åšå®Œï¼Œç¡®å®šè¦ç›´æ¥äº¤å·å—ï¼Ÿ`);
            if (!goOn) return;
        }

        const results = [];
        let score = 0;

        const campScores = {
            zhangqiang: 0,
            lintao: 0,
            meanwei: 0,
            cha: 0,
            lihua: 0
        };

        questions.forEach(question => {
            const selectedOption = document.querySelector(`input[name="question-${question.id}"]:checked`);
            const userAnswer = selectedOption ? selectedOption.value : 'æœªå›ç­”';
            const isCorrect = userAnswer === question.correctAnswer;

            if (isCorrect) score++;

            if (selectedOption) {
                const meta = findOptionMeta(question, userAnswer);
                if (meta) {
                    if (meta.character === 'cha-all') {
                        campScores.zhangqiang++;
                        campScores.lintao++;
                        campScores.meanwei++;
                        campScores.cha++;
                        campScores.lihua++;
                    } else if (campScores.hasOwnProperty(meta.character)) {
                        campScores[meta.character]++;
                    }
                }
            }

            results.push({
                question: question.text,
                userAnswer,
                correctAnswer: question.correctAnswer,
                isCorrect
            });
        });

        displayResults(results, score, campScores);
    }

    function getCampResult(campScores) {
        let bestKey = 'neutral';
        let bestScore = 0;

        Object.entries(campScores).forEach(([key, value]) => {
            if (value > bestScore) {
                bestScore = value;
                bestKey = key;
            }
        });

        return { key: bestKey, score: bestScore };
    }

    function displayResults(results, score, campScores) {
        const resultsContainer = document.getElementById('results');
        resultsContainer.style.display = 'block';

        const total = questions.length;
        let levelText = '';
        if (score === total) {
            levelText = 'ä½ æ˜¯æ¶äººè°·è€ƒå¤ç»„æ ¸å¿ƒæˆå‘˜ï¼Œè¿ç»†èŠ‚éƒ½åˆ»åœ¨éª¨å¤´é‡Œã€‚';
        } else if (score >= total - 1) {
            levelText = 'å·²ç»éå¸¸å…¥è°·ï¼Œè¯´æ˜ä½ ä¸ä»…çœ‹è¿‡ï¼Œè¿˜åœ¨åå¤é‡æ¸©ååœºé¢ã€‚';
        } else if (score >= total / 2) {
            levelText = 'åˆæ ¼å…¥è°·è€…ï¼Œå†å¤šåˆ·å‡ éï¼Œä½ å°±å¯ä»¥å¼€å§‹çº ç»“æ—¶é—´çº¿äº†ã€‚';
        } else if (score > 0) {
            levelText = 'ä½ åœ¨é—¨å£æ¢å¤´ï¼Œæ¶äººè°·è¿˜æ²¡å®Œå…¨å¼ å˜´å’¬ä½ä½ ã€‚ç°åœ¨å›å¤´è¿˜æ¥å¾—åŠã€‚å¤§æ¦‚ã€‚';
        } else {
            levelText = 'ä½ æ˜¯çº¯çˆ±æˆ˜å£«/è·¯è¿‡ç¾¤ä¼—ï¼Œåªæ˜¯è¢«æœ‹å‹ç¡¬æ‹‰è¿›æ¥åšäº†ä¸€ä»½å·ã€‚';
        }

        const campResult = getCampResult(campScores);
        const campProfile = characterProfiles[campResult.key] || characterProfiles.neutral;
        const randomQuote = evilQuotes[Math.floor(Math.random() * evilQuotes.length)];

        let html = `
            <div class="score-display">
                <div>ä½ çš„å¾—åˆ†</div>
                <div class="score-value">${score} / ${total}</div>
                <div class="tagline">${levelText}</div>
            </div>

            <div class="camp-result">
                <div class="camp-name">
                    <i class="fas fa-mask"></i>
                    <span>${campProfile.name}</span>
                    <span class="badge">${campProfile.badge}</span>
                </div>
                <div style="font-size:0.95rem; line-height:1.5; margin-top:4px;">
                    ${campProfile.desc}
                </div>
                <div class="evil-quote">${randomQuote}</div>
            </div>
        `;

        results.forEach((result, index) => {
            html += `
                <div class="result-item ${result.isCorrect ? 'correct' : 'incorrect'}">
                    <div class="question-text" style="margin-left:0; font-size:1rem;">
                        ${index + 1}. ${result.question}
                    </div>
                    <div style="margin-top:6px;">ä½ çš„ç­”æ¡ˆï¼š<strong>${result.userAnswer}</strong></div>
                    <div>æ­£ç¡®ç­”æ¡ˆï¼š<strong>${result.correctAnswer}</strong></div>
                    <div style="margin-top: 5px; color: ${result.isCorrect ? '#00cc66' : '#ff0033'}">
                        <i class="fas ${result.isCorrect ? 'fa-check-circle' : 'fa-times-circle'}"></i>
                        ${result.isCorrect ? ' æ­£ç¡®' : ' é”™è¯¯'}
                    </div>
                </div>
            `;
        });

        resultsContainer.innerHTML = html;
        resultsContainer.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }

    function resetSurvey() {
        if (!confirm('ç¡®å®šè¦é‡ç½®é—®å·å—ï¼Ÿæ‰€æœ‰ç­”æ¡ˆå’Œç»“æœéƒ½ä¼šè¢«æ¸…é™¤ã€‚')) return;

        const radios = document.querySelectorAll('input[type="radio"]');
        radios.forEach(r => r.checked = false);

        const resultsContainer = document.getElementById('results');
        resultsContainer.style.display = 'none';
        resultsContainer.innerHTML = '<h2><i class="fas fa-poll"></i> é—®å·ç»“æœ</h2>';

        updateProgress();
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    document.addEventListener('DOMContentLoaded', init);
</script>
</body>
</html>
